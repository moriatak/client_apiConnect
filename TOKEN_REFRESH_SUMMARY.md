# ×¡×™×›×•×: ×ž×¢×¨×›×ª ×¨×¢× ×•×Ÿ ×˜×•×›×Ÿ ××•×˜×•×ž×˜×™×ª âœ…

## ðŸŽ¯ ×ž×” ×¢×©×™× ×•?

×”×•×¡×¤× ×• ×ž×¢×¨×›×ª ×©×ž×¨×¢× × ×ª **××•×˜×•×ž×˜×™×ª** ××ª ×”×˜×•×›×Ÿ ×œ×¤× ×™ ×©×”×•× ×¤×’ ×ª×•×§×£, ×›×“×™ ×œ×ž× ×•×¢ ×ž×”×©×¨×ª Node.js ×œ×§×‘×œ ×˜×•×›×Ÿ ×¤×’.

## ðŸ”„ ××™×š ×–×” ×¢×•×‘×“?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ×ž×©×ª×ž×© × ×›× ×¡ ×¢× ×˜×•×›×Ÿ ×©×¤×’ ×ª×•×§×£ ×‘×¢×•×“ ×“×§×ª×™×™×              â”‚
â”‚     âœ… ×˜×•×›×Ÿ ×ž××•×ž×ª, ××¤×œ×™×§×¦×™×” × ×˜×¢× ×ª                         â”‚
â”‚     ðŸ” ×ž×¢×¨×›×ª ×¨×¢× ×•×Ÿ ×ž×•×¤×¢×œ×ª                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ×›×œ 30 ×©× ×™×•×ª: ×‘×“×™×§×” ××•×˜×•×ž×˜×™×ª                          â”‚
â”‚     â° ×–×ž×Ÿ ×¢×“ ×ª×¤×•×’×”: 120 ×©× ×™×•×ª (2 ×“×§×•×ª)                  â”‚
â”‚     â° ×–×ž×Ÿ ×¢×“ ×ª×¤×•×’×”: 90 ×©× ×™×•×ª (1.5 ×“×§×•×ª)                 â”‚
â”‚     â° ×–×ž×Ÿ ×¢×“ ×ª×¤×•×’×”: 60 ×©× ×™×•×ª (1 ×“×§×”)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. ×¤×—×•×ª ×ž×“×§×” ×œ×¤× ×™ ×ª×¤×•×’×”!                                â”‚
â”‚     â° ×–×ž×Ÿ ×¢×“ ×ª×¤×•×’×”: 45 ×©× ×™×•×ª (0 ×“×§×•×ª)                   â”‚
â”‚     âš ï¸  ×˜×•×›×Ÿ ×§×¨×•×‘ ×œ×¤×•×’ - ×ž×¨×¢× ×Ÿ ×¢×›×©×™×•!                    â”‚
â”‚     ðŸ”„ ×§×•×¨× ×œ-refresh endpoint                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                    â”‚             â”‚
                    â–¼             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ×”×¦×œ×—×” âœ…     â”‚   â”‚  ×›×™×©×œ×•×Ÿ âŒ   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                   â”‚
                â–¼                   â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… ×˜×•×›×Ÿ ×ž×¢×•×“×›×Ÿ  â”‚    â”‚ âŒ ×¡×©×Ÿ ×¤×’ ×ª×•×§×£ â”‚
    â”‚ ðŸ†• ×ª×¤×•×’×”: +2minâ”‚    â”‚ ðŸšª × ×™×ª×•×§ ×ž×©×ª×ž×© â”‚
    â”‚ ðŸŽ‰ ×—×•×–×¨ ×œ×¢×‘×•×“×” â”‚    â”‚ ðŸ“› ×ž×¡×š ×©×’×™××”   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“ ×§×‘×¦×™× ×©×¢×•×“×›× ×•

### 1. [src/contexts/AuthContext.jsx](src/contexts/AuthContext.jsx)
- âœ… ×”×•×¡×¤× ×• `refreshToken()` - ×¤×•× ×§×¦×™×” ×œ×¨×¢× ×•×Ÿ ×˜×•×›×Ÿ
- âœ… ×”×•×¡×¤× ×• `checkAndRefreshToken()` - ×‘×“×™×§×” ×× ×¦×¨×™×š ×œ×¨×¢× ×Ÿ
- âœ… ×”×•×¡×¤× ×• `setInterval` - ×‘×“×™×§×” ×›×œ 30 ×©× ×™×•×ª

### 2. [src/utils/auth.js](src/utils/auth.js)
- âœ… ×”×•×¡×¤× ×• `getExpiresAt()` - ×ž×—×–×™×¨ ×ª××¨×™×š ×ª×¤×•×’×”

## ðŸŽ® ××™×š ×œ×”×©×ª×ž×©?

**××™×Ÿ ×¦×•×¨×š ×œ×¢×©×•×ª ×›×œ×•×!** ðŸŽ‰

×”×ž×¢×¨×›×ª ×¢×•×‘×“×ª **××•×˜×•×ž×˜×™×ª** ×‘×¨×§×¢:
1. ×ž×©×ª×ž×© × ×›× ×¡ ×“×¨×š ×”×¤×•×¨×˜×œ â†’ ×˜×•×›×Ÿ ×ž××•×ž×ª
2. ×”×ž×¢×¨×›×ª ×‘×•×“×§×ª ×›×œ 30 ×©× ×™×•×ª ×× ×”×˜×•×›×Ÿ ×§×¨×•×‘ ×œ×¤×•×’
3. ×›×©× ×©××¨ ×¤×—×•×ª ×ž×“×§×” â†’ ×¨×¢× ×•×Ÿ ××•×˜×•×ž×˜×™
4. ×”×ž×©×ª×ž×© ×ž×ž×©×™×š ×œ×¢×‘×•×“ **×œ×œ× ×”×¤×¨×¢×”**!

## ðŸ” ××™×š ×œ×‘×“×•×§ ×©×–×” ×¢×•×‘×“?

### ×‘×“×™×§×” ×ž×”×™×¨×”:

1. **×¤×ª×— ×§×•× ×¡×•×œ** (F12)
2. **×”×™×›× ×¡** ×œ××ª×¨ ×“×¨×š ×”×¤×•×¨×˜×œ
3. **×—×¤×©** ××ª ×”×œ×•×’×™×:
   ```
   âœ… ×ž×©×ª×ž×© ×ž××•×ž×ª - ×ž×¤×¢×™×œ ×ž×¢×¨×›×ª ×¨×¢× ×•×Ÿ ×˜×•×›×Ÿ ××•×˜×•×ž×˜×™×ª
   â° ×–×ž×Ÿ ×¢×“ ×ª×¤×•×’×ª ×˜×•×›×Ÿ: 120 ×©× ×™×•×ª (2 ×“×§×•×ª)
   ```

4. **×—×›×”** ×¢×“ ×©× ×©××¨ ×¤×—×•×ª ×ž×“×§×” (××• ×©× ×” ×–×ž× ×™×ª ××ª threshold ×œ-120)
5. **×¦×¤×•×™ ×œ×¨××•×ª**:
   ```
   âš ï¸ ×˜×•×›×Ÿ ×§×¨×•×‘ ×œ×¤×•×’ ×ª×•×§×£ - ×ž×¨×¢× ×Ÿ ×¢×›×©×™×•
   ðŸ”„ ×ž× ×¡×” ×œ×¨×¢× ×Ÿ ×˜×•×›×Ÿ...
   âœ… ×˜×•×›×Ÿ ×¨×•×¢× ×Ÿ ×‘×”×¦×œ×—×”
   ðŸ†• ×˜×•×›×Ÿ ×—×“×© ×¤×’ ×ª×•×§×£ ×‘: 31.12.2025, 13:40:00
   ```

### ×‘×“×™×§×” ×‘-Network Tab:

1. ×¤×ª×— **Network** tab
2. ×¡× ×Ÿ ×œ×¤×™: `refresh_token.php`
3. ×›×©×”×˜×•×›×Ÿ ×ž×ª×¨×¢× ×Ÿ - ×ª×¨××” ×‘×§×©×”:
   ```
   POST https://portal.tak.co.il/.../refresh_token.php
   Status: 200 OK
   Response: {"success": true, "token": "...", "expiresAt": ...}
   ```

## ðŸ†˜ ×ž×” ×§×•×¨×” ×× ×”×¡×©×Ÿ ×¤×’ ×‘×¤×•×¨×˜×œ?

×× ×”×ž×©×ª×ž×© ×”×ª× ×ª×§ ×ž×”×¤×•×¨×˜×œ ××• ×”×¡×©×Ÿ ×¤×’:

1. **×¨×¢× ×•×Ÿ × ×›×©×œ** ×¢× 401 Unauthorized
2. **×œ×•×’ ×‘×§×•× ×¡×•×œ**:
   ```
   âŒ ×¨×¢× ×•×Ÿ ×˜×•×›×Ÿ × ×›×©×œ: Session expired
   âŒ ×”×¡×©×Ÿ ×‘×¤×•×¨×˜×œ ×¤×’ ×ª×•×§×£ - ×ž× ×ª×§ ×ž×©×ª×ž×©
   ```
3. **×ž×¡×š ×©×’×™××” ××“×•×**:
   ```
   ×©×’×™××ª ××™×ž×•×ª
   ×”×¡×©×Ÿ ×¤×’ ×ª×•×§×£. ×× × ×”×ª×—×‘×¨ ×ž×—×“×© ×“×¨×š ×”×¤×•×¨×˜×œ
   ```

## âš™ï¸ ×”×’×“×¨×•×ª

### ×–×ž×Ÿ ×‘×“×™×§×” (×‘×¨×™×¨×ª ×ž×—×“×œ: 30 ×©× ×™×•×ª)
```javascript
// ×‘-AuthContext.jsx
const refreshInterval = setInterval(() => {
  checkAndRefreshToken();
}, 30000); // 30 ×©× ×™×•×ª
```

### Threshold ×œ×¨×¢× ×•×Ÿ (×‘×¨×™×¨×ª ×ž×—×“×œ: 60 ×©× ×™×•×ª)
```javascript
// ×‘-AuthContext.jsx
if (timeUntilExpiry < 60) { // ×“×§×” ×œ×¤× ×™ ×ª×¤×•×’×”
  refreshToken();
}
```

## ðŸ“Š ×“×•×’×ž×ª Timeline

```
×–×ž×Ÿ    | ××™×¨×•×¢                           | ×˜×•×›×Ÿ ×¤×’ ×ª×•×§×£ ×‘-
-------|----------------------------------|------------------
00:00  | ×›× ×™×¡×” - ×˜×•×›×Ÿ ×ª×§×£                | 00:02 (×“×§×ª×™×™×)
00:30  | ×‘×“×™×§×”: 90 ×©× ×™×•×ª × ×©××¨×•          | 00:02
01:00  | ×‘×“×™×§×”: 60 ×©× ×™×•×ª × ×©××¨×•          | 00:02
01:30  | ×‘×“×™×§×”: 30 ×©× ×™×•×ª â†’ ðŸ”„ ×¨×¢× ×•×Ÿ!   | 00:02
01:31  | âœ… ×˜×•×›×Ÿ ×—×“×© ×”×ª×§×‘×œ               | 03:31 (×“×§×ª×™×™×)
02:00  | ×‘×“×™×§×”: 91 ×©× ×™×•×ª × ×©××¨×•          | 03:31
02:30  | ×‘×“×™×§×”: 61 ×©× ×™×•×ª × ×©××¨×•          | 03:31
03:00  | ×‘×“×™×§×”: 31 ×©× ×™×•×ª â†’ ðŸ”„ ×¨×¢× ×•×Ÿ!   | 03:31
03:01  | âœ… ×˜×•×›×Ÿ ×—×“×© ×”×ª×§×‘×œ               | 05:01
... ×•×”×ª×”×œ×™×š ×—×•×–×¨ ×¢×œ ×¢×¦×ž×•!
```

## âœ… ×ž×” ×”×‘×?

1. **×‘× ×” ××ª ×”××¤×œ×™×§×¦×™×”**:
   ```bash
   npm run build
   ```

2. **×¤×¨×•×¡ ×œ×“×•×§×¨**:
   - ×”×¢×œ×™ ××ª `dist/`

3. **×‘×“×•×§**:
   - ×›× ×¡ ×“×¨×š ×”×¤×•×¨×˜×œ
   - ×‘×“×•×§ ××ª ×”×§×•× ×¡×•×œ
   - ×•×“× ×©×”×˜×•×›×Ÿ ×ž×ª×¨×¢× ×Ÿ

## ðŸ“š ×ª×™×¢×•×“ ×ž×œ×

×§×¨× ××ª [TOKEN_REFRESH_README.md](TOKEN_REFRESH_README.md) ×œ×¤×¨×˜×™× ×ž×œ××™×!

---

**×”×›×œ ×ž×•×›×Ÿ! ðŸŽ‰**

×”×ž×¢×¨×›×ª ×ª×¢×‘×•×“ **××•×˜×•×ž×˜×™×ª** ×•×ª×ž× ×¢ ×ž×”×©×¨×ª ×œ×§×‘×œ ×˜×•×›×Ÿ ×¤×’ ×ª×•×§×£.

×”×ž×©×ª×ž×© ×™×•×›×œ ×œ×¢×‘×•×“ **×œ×œ× ×”×¤×¨×¢×•×ª** ×›×œ ×¢×•×“ ×”×¡×©×Ÿ ×‘×¤×•×¨×˜×œ ×¤×¢×™×œ! ðŸš€
